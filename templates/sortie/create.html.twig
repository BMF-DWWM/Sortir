{% extends 'base.html.twig' %}


{% block body %}
    {% if app.user  %}
        <h1> Hello {{ app.User.prenom}} {{ app.user.nom }}</h1>
    {% else %}
        <h1>Bonjour visiteur</h1>
    {% endif %}
    <div class="form">
        {{ form_start(createSortieForm) }}
        {{ form_row(createSortieForm.nom) }}
        {{ form_row(createSortieForm.dateHeureDebut) }}
        {{ form_row(createSortieForm.duree) }}
        {{ form_row(createSortieForm.nbInscriptionsMax) }}
        {{ form_row(createSortieForm.infosSortie) }}
        {{ form_row(createSortieForm.campus) }}
        <div id="liste_lieu">
            {{ form_row(createSortieForm.Lieu) }}
        </div>

        {{ form_end(createSortieForm) }}
    </div>
    <div>
        <button id="afficher_lieu_form">Creer un lieu!</button>
        <button style="display: none" id="afficher_liste_lieu">Afficher la liste!</button>
        <div style="display: none" id="formulaire_lieu">
            {{ form_start(createLieuForm) }}
            {{ form_widget(createLieuForm)}}
            <button>Submit le lieu!</button>
            {{ form_end(createLieuForm)}}
        </div>
    </div>
{#    <script type="text/javascript" >#}

{#        window.onload = () => {#}
{#            let ville = document.querySelector("#create_sortie_ville");#}
{#            ville.addEventListener("change", function(){#}
{#                let form = this.closest("form");#}
{#                let data = this.name+ "=" + this.value;#}
{#                console.log(data)#}
{#                fetch(form.action, {#}
{#                    method: form.getAttribute("method"),#}
{#                    body: data,#}
{#                    headers: {#}
{#                        "Content-Type":"application/x-www-form-urlencoded" +#}
{#                            "charset:utf-8"#}
{#                    }#}
{#                })#}
{#                .then(response => response.text())#}

{#                .then(html => {#}
{#                    let content = document.createElement("html");#}
{#                    content.innerHTML = html;#}
{#                    console.log(html)#}
{#                    let nouveauSelect = content.querySelector("#create_sortie_Lieu")#}
{#                    console.log(nouveauSelect)#}
{#                    console.log(nouveauSelect)#}
{#                    document.querySelector("#create_sortie_Lieu").replaceWith(nouveauSelect)#}
{#                })#}
{#                .catch(error =>{#}
{#                    console.log(error)#}
{#                })#}
{#            })#}
{#        }#}
{#    </script>#}
    <script>
        var $ville = $('#create_sortie_ville');
        // When sport gets selected ...
        $ville.change(function() {
            // ... retrieve the corresponding form.
            var $form = $(this).closest('form');
            // Simulate form data, but only include the selected sport value.
            var data = {};
            data[$ville.attr('name')] = $ville.val();
            console.log(data)
            // Submit data via AJAX to the form's action path.
            $.ajax({
                url : $form.attr('action'),
                type: $form.attr('method'),
                data : data,
                success: function(html) {
                    // Replace current position field ...
                    $('#create_sortie_Lieu').replaceWith(
                        // ... with the returned one from the AJAX response.
                        $(html).find('#create_sortie_Lieu')
                    );
                    // Position field now displays the appropriate positions.
                }
            });
        });
    </script>

    <script type="text/javascript" >

        document.getElementById('afficher_lieu_form').onclick = function afficher(){
            if(document.getElementById('formulaire_lieu').style.display == "none"){
                document.getElementById('formulaire_lieu').style.display = "block";
                document.getElementById('liste_lieu').style.display= "none";
                document.getElementById('afficher_lieu_form').style.display= "none";
                document.getElementById('afficher_liste_lieu').style.display= "block";
            }
        }

    </script>
    <script type="text/javascript" >
        document.getElementById('afficher_liste_lieu').onclick = function enlever(){
            document.getElementById('formulaire_lieu').style.display = "none";
                document.getElementById('liste_lieu').style.display= "block";
                document.getElementById('afficher_lieu_form').style.display= "block";
                document.getElementById('afficher_liste_lieu').style.display= "none";
        }
    </script>

{% endblock %}

{% block title  %}{{ parent() }} | Home {% endblock %}